<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>ë©”ì¸ í˜ì´ì§€</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'main-bg': '#232b39',
            'banner-yellow': '#facc15'
          }
        }
      }
    }
  </script>
</head>
<body class="bg-main-bg min-h-screen w-full">
<!-- ë°°ë„ˆ -->
<div class="w-full bg-main-bg py-6">
  <div class="text-banner-yellow text-4xl italic font-bold text-center">Banner</div>
</div>
<!-- ë©”ì¸ ì˜ì—­ -->
<div class="flex flex-row gap-8 px-8 py-8 w-full max-w-[1600px] mx-auto">
  <!-- ì™¼ìª½: íƒ­ + ì½˜í…ì¸  -->
  <div class="flex-1 flex flex-col">
    <!-- íƒ­ ë²„íŠ¼ -->
    <div class="flex space-x-2 mb-0">
      <button id="tab-board-btn" class="tab-btn bg-white text-main-bg font-bold px-8 py-3 rounded-t-xl shadow -mb-1 border-b-4 border-main-bg">ê²Œì‹œíŒ</button>
      <button id="tab-stock-btn" class="tab-btn bg-gray-700 text-white font-bold px-8 py-3 rounded-t-xl shadow -mb-1">ì£¼ì‹</button>
      <button id="tab-game-btn" class="tab-btn bg-gray-700 text-white font-bold px-8 py-3 rounded-t-xl shadow -mb-1">ê²Œì„</button>
    </div>
    <!-- ì½˜í…ì¸  ì¹´ë“œ -->
    <div class="flex-1 bg-white rounded-b-xl rounded-tr-xl shadow-2xl p-8 min-h-[500px]">
      <!-- ê²Œì‹œíŒ -->
		<div id="tab-board" class="tab-content">
		  <h2 class="text-2xl font-bold mb-6 text-gray-800">ê²Œì‹œíŒ</h2>
		  <div class="overflow-auto">
		    <table class="w-full text-left border-collapse">
		      <thead class="bg-gray-50">
		      <tr>
		        <th class="py-3 px-6 border-b font-semibold text-gray-700">ë²ˆí˜¸</th>
		        <th class="py-3 px-6 border-b font-semibold text-gray-700">ì œëª©</th>
		        <th class="py-3 px-6 border-b font-semibold text-gray-700">ì‘ì„±ì</th>
		        <th class="py-3 px-6 border-b font-semibold text-gray-700">ì‘ì„±ì¼</th>
		        <th class="py-3 px-6 border-b font-semibold text-gray-700">ì¡°íšŒìˆ˜</th>
		        <th class="py-3 px-6 border-b font-semibold text-gray-700">ëŒ“ê¸€ìˆ˜</th>
		      </tr>
		      </thead>
		      <tbody>
		      <tr th:each="post, stat : ${postPage.content}" class="hover:bg-gray-50">
		        <td class="py-3 px-6 border-b" th:text="${post.postId}">1</td>
		        <td class="py-3 px-6 border-b">
		          <a th:href="@{/posts/{id}(id=${post.postId})}" th:text="${post.title}" class="text-blue-600 hover:underline">ì œëª©</a>
		        </td>
		        <td class="py-3 px-6 border-b" th:text="${post.member.name}">ì‘ì„±ì</td>
		        <td class="py-3 px-6 border-b" th:text="${post.postTime}">2025-06-17</td>
		        <td class="py-3 px-6 border-b" th:text="${post.viewCount}">0</td>
		        <td class="py-3 px-6 border-b" th:text="${post.replyCount}">0</td>
		      </tr>
		      <tr th:if="${#lists.isEmpty(postPage.content)}">
		        <td colspan="6" class="text-center text-gray-400 py-8">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</td>
		      </tr>
		      </tbody>
		    </table>
		  </div>
		  <!-- í˜ì´ì§• ë„¤ë¹„ê²Œì´ì…˜ -->
		  <div class="flex justify-center mt-6 gap-2">
		    <a th:if="${postPage.hasPrevious()}" th:href="@{/(page=${postPage.number - 1})}"
		       class="px-3 py-1 rounded bg-gray-200 text-gray-700 hover:bg-gray-300">ì´ì „</a>
		    <span th:each="i : ${#numbers.sequence(0, postPage.totalPages - 1)}">
		      <a th:href="@{/(page=${i})}"
		         th:text="${i + 1}"
		         th:classappend="${i == postPage.number} ? 'bg-blue-500 text-white' : 'bg-gray-200 text-gray-700'"
		         class="px-3 py-1 rounded mx-1 hover:bg-blue-200"></a>
		    </span>
		    <a th:if="${postPage.hasNext()}" th:href="@{/(page=${postPage.number + 1})}"
		       class="px-3 py-1 rounded bg-gray-200 text-gray-700 hover:bg-gray-300">ë‹¤ìŒ</a>
		  </div>
		</div>
		<!-- ì£¼ì‹ (ë³€ë™ì„± í‘œì‹œ ì ìš©) -->
		<div id="tab-stock" class="tab-content hidden">
			<h2 class="text-2xl font-bold mb-6 text-gray-800">ì£¼ì‹</h2>
			<div class="space-y-4">
				<!-- ì£¼ì‹ ì•„ì´í…œ ì¹´ë“œ (Thymeleaf ë°˜ë³µë¬¸) -->
				<div th:each="stock : ${stockList}" class="bg-gray-800 rounded-lg shadow-lg overflow-hidden" th:id="'stock-card-' + ${stock.stockId}">
					<!-- ìƒë‹¨: ì¢…ëª© ì •ë³´ ë° ë³€ë™ì„± -->
					<div class="flex items-center justify-between text-white p-4">
						<span class="text-lg font-semibold" th:text="${stock.stockName}">ì¢…ëª©ëª…</span>
						<div class="flex items-center text-right">
							<!-- âœ… class="stock-price" ì¶”ê°€ -->
							<span class="text-lg font-semibold stock-price" th:text="${#numbers.formatDecimal(stock.price, 0, 'COMMA', 0, 'POINT')} + 'ì›'">ê°€ê²©</span>
							<!-- âœ… class="stock-change" ì¶”ê°€ -->
							<div class="ml-4 w-28 text-sm stock-change"
								 th:classappend="${stock.priceChangeAmount > 0 ? 'text-red-500' : (stock.priceChangeAmount < 0 ? 'text-blue-500' : 'text-gray-400')}">
								<span th:text="${stock.priceChangeAmount >= 0 ? 'â–²' : 'â–¼'}"></span>
								<span th:text="${#numbers.formatDecimal(stock.priceChangeAmount, 0, 'COMMA', 0, 'POINT')}"></span>
								<span class="block" th:text="'(' + ${#numbers.formatDecimal(stock.priceChangeRate, 1, 2)} + '%)'"></span>
							</div>
						</div>
					</div>

					<!-- í•˜ë‹¨: ë§¤ìˆ˜/ë§¤ë„ ë° ë³´ìœ ìˆ˜ëŸ‰ (ë¡œê·¸ì¸ ì‹œ) -->
					<div th:if="${member != null}" class="bg-gray-700/50 p-3 flex items-center justify-between space-x-4">
						<!-- ë³´ìœ ìˆ˜ëŸ‰ -->
						<div class="text-white text-sm">
							ë‚´ ë³´ìœ ìˆ˜ëŸ‰: <strong class="text-lg" th:text="${stock.userQuantity}">0</strong>
						</div>
						<!-- ë§¤ìˆ˜/ë§¤ë„ í¼ -->
						<div class="flex items-center space-x-2">
							<!-- ë§¤ìˆ˜ Form -->
							<form th:action="@{/stocks/buy}" method="post" class="flex items-center space-x-2"
								  th:onsubmit="${member == null} ? 'event.preventDefault(); alert(\'ë¡œê·¸ì¸ í•˜ì„¸ìš”\');' : ''">
								<input type="hidden" name="stockId" th:value="${stock.stockId}" />
								<input type="number" name="quantity" value="1" min="1" class="w-20 bg-gray-900 border border-gray-600 rounded px-2 py-1 text-center text-white"/>
								<button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-1.5 rounded font-semibold transition">ë§¤ìˆ˜</button>
							</form>
							<!-- ë§¤ë„ Form -->
							<form th:action="@{/stocks/sell}" method="post" class="flex items-center space-x-2"
								  th:onsubmit="${member == null} ? 'event.preventDefault(); alert(\'ë¡œê·¸ì¸ í•˜ì„¸ìš”\');' : ''">
								<input type="hidden" name="stockId" th:value="${stock.stockId}" />
								<input type="number" name="quantity" value="1" min="1" th:max="${stock.userQuantity > 0 ? stock.userQuantity : 1}" class="w-20 bg-gray-900 border border-gray-600 rounded px-2 py-1 text-center text-white"/>
								<button type="submit" class="bg-red-600 hover:bg-red-700 text-white px-4 py-1.5 rounded font-semibold transition" th:disabled="${stock.userQuantity == 0}">ë§¤ë„</button>
							</form>
						</div>
					</div>

					<!-- í•˜ë‹¨: ë¡œê·¸ì¸ ì•ˆë‚´ ë©”ì‹œì§€ (ë¹„ë¡œê·¸ì¸ ì‹œ) -->
					<div th:if="${member == null}" class="bg-gray-700/50 p-4 text-center">
						<span class="text-gray-400">ë§¤ìˆ˜/ë§¤ë„ ê¸°ëŠ¥ì€ ë¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.</span>
					</div>
				</div>
			</div>
		</div>
      <!-- ê²Œì„ -->
      	<div id="tab-game" class="tab-content hidden max-w-xs mx-auto p-4 bg-white rounded shadow">
		  <h2 class="text-2xl font-bold mb-6 text-gray-800">ê²Œì„</h2>
		  <div id="game-content">
		    <div class="text-gray-600 text-base mb-4">ê²Œì„ì„ ì„ íƒí•˜ì„¸ìš”.</div>
		    <div class="flex gap-2">
		      <button id="btn-even-odd" class="px-3 py-2 bg-blue-500 text-white rounded text-sm">í™€ì§</button>
		      <button id="btn-updown" class="px-3 py-2 bg-green-500 text-white rounded text-sm">UPDOWN</button>
		    </div>
		    <div class="mt-4 text-sm text-gray-700">
		      ë‚´ í¬ì¸íŠ¸: <span id="current-point">0</span>
		    </div>
		  </div>
		</div>
    </div>
  </div>
  <!-- ì˜¤ë¥¸ìª½: ë‚´ì •ë³´/ë¡œê·¸ì¸ -->
  <div class="w-[400px] flex-shrink-0 flex flex-col">
    <div class="flex">
      <div class="bg-white rounded-t-xl px-8 py-3 font-bold text-main-bg text-xl -mb-1 shadow-lg border-b-4 border-main-bg">
         <span th:if="${member != null}">ë‚´ì •ë³´</span>
  		 <span th:if="${member == null}">ë¡œê·¸ì¸</span>
      </div>
    </div>
    <div class="flex-1 bg-white rounded-b-xl rounded-tr-xl shadow-2xl p-8 flex flex-col min-h-[500px]">
     <!-- ë¡œê·¸ì¸ ìƒíƒœ: ë‚´ì •ë³´ -->
		<div th:if="${member != null}" class="h-full flex flex-col justify-between">
		  <div>
		    <div class="flex justify-between mb-2">
		      <span class="text-gray-600 text-base">ID</span>
		      <span class="text-gray-600 text-base">ë“±ê¸‰</span>
		    </div>
		    <div class="flex justify-between mb-2">
		      <span class="text-gray-800 text-lg font-semibold" th:text="${member?.name ?: ''}">user01</span>
		      <span class="text-blue-600 text-lg font-semibold" th:text="${member?.rank ?: ''}">Bronze</span>
		    </div>
		    <div class="flex justify-between mb-2">
		      <span class="text-gray-600 text-base">ë³´ìœ  í¬ì¸íŠ¸</span>
				<span class="text-green-600 text-xl font-bold"
					  th:text="${@formatUtils.formatKoreanWon(member.point)}">10,000ì›</span>
		    </div>
		    <div class="flex justify-between text-gray-500 text-sm mt-4">
		      <span>ì‘ì„±í•œ ê²Œì‹œê¸€ ìˆ˜: <span class="font-semibold" th:text="${member?.postCount ?: 0}">0</span></span>
		      <span>ì‘ì„±í•œ ëŒ“ê¸€ ìˆ˜: <span class="font-semibold" th:text="${member?.replyCount ?: 0}">0</span></span>
		    </div>

			  <!-- âœ… ë³´ìœ  ì£¼ì‹ í˜„í™© ì„¹ì…˜ì„ ì•„ë˜ ì½”ë“œë¡œ êµì²´í•©ë‹ˆë‹¤. -->
			  <div class="mt-4 pt-4 border-t border-gray-300">
				  <h3 class="text-gray-700 font-semibold mb-2">ë³´ìœ  ì£¼ì‹ í˜„í™©</h3>

				  <div th:if="${#lists.isEmpty(ownedStockViewList)}" class="text-gray-500 text-sm">
					  ë³´ìœ í•œ ì£¼ì‹ì´ ì—†ìŠµë‹ˆë‹¤.
				  </div>

				  <div th:unless="${#lists.isEmpty(ownedStockViewList)}" class="space-y-2 text-sm mb-3">
					  <!-- ë³´ìœ  ì£¼ì‹ ëª©ë¡ ë°˜ë³µ -->
					  <div th:each="stock : ${ownedStockViewList}" class="p-2 rounded bg-gray-50">
						  <div class="flex justify-between items-center font-semibold">
							  <span class="text-gray-800" th:text="${stock.stockName}">ì‚¼ì„±ì „ì</span>
							  <!-- âœ… í‰ë‹¨ê°€ í‘œì‹œ (ìƒˆë¡œ ì¶”ê°€) -->
							  <span class="text-xs text-black-500 font-semibold"
									th:text="${@formatUtils.formatKoreanWon(stock.averagePurchasePrice)}">@ 83,000ì›</span>

							  <span class="text-gray-600" th:text="${stock.quantity} + 'ì£¼'">10ì£¼</span>
						  </div>
						  <div class="flex justify-between items-center mt-1 text-xs"
							   th:classappend="${stock.profitLossAmount > 0 ? 'text-red-600' : (stock.profitLossAmount < 0 ? 'text-blue-600' : 'text-gray-500')}">
							  <!-- âœ… ë‘ ë²ˆì§¸ ì¤„: í‰ê°€ ê¸ˆì•¡ (ìƒˆë¡œ ì¶”ê°€ëœ ë¶€ë¶„) -->
							  <div class="flex justify-end items-center mt-1 text-gray-800 font-semibold">
								  <span th:text="${@formatUtils.formatKoreanWon(stock.totalCurrentValue)}">850,000ì›</span>
							  </div>
							  <!-- í‰ê°€ ì†ìµ (ë¶€í˜¸ ì²˜ë¦¬ ìˆ˜ì •) -->
							  <span th:text="${(stock.profitLossAmount > 0 ? '+' : (stock.profitLossAmount < 0 ? '-' : '')) + @formatUtils.formatKoreanWon(T(java.lang.Math).abs(stock.profitLossAmount))}"></span>
							  <!-- ìˆ˜ìµë¥  -->
							  <span th:text="'(' + ${#numbers.formatDecimal(stock.profitLossRate, 1, 2)} + '%)'"></span>
						  </div>
					  </div>
				  </div>

				  <!-- ì´ ìì‚° í˜„í™© (ìˆ˜ì •ëœ ë²„ì „) -->
				  <div class="border-t border-gray-200 pt-3 mt-3">
					  <!-- 1. ì´ ì£¼ì‹ í‰ê°€ì•¡ -->
					  <div class="flex justify-between items-center">
						  <span class="text-gray-800 font-bold">ì´ ì£¼ì‹ í‰ê°€ì•¡</span>
						  <span class="text-lg font-bold"
								th:classappend="${totalProfitLoss > 0 ? 'text-red-600' : (totalProfitLoss < 0 ? 'text-blue-600' : 'text-gray-800')}"
								th:text="${@formatUtils.formatKoreanWon(totalStockValue)}">1,710,000ì›</span>
					  </div>
					  <!-- 2. ì´ í‰ê°€ ì†ìµ ë° ìˆ˜ìµë¥  -->
					  <div class="flex justify-end items-baseline space-x-2 text-sm mt-1">
       		 <span th:classappend="${totalProfitLoss > 0 ? 'text-red-600' : (totalProfitLoss < 0 ? 'text-blue-600' : 'text-gray-500')}"
			  th:text="${(totalProfitLoss > 0 ? '+' : (totalProfitLoss < 0 ? '-' : '')) + @formatUtils.formatKoreanWon(T(java.lang.Math).abs(totalProfitLoss))}">
              +60,000ì›</span>
						  <span th:classappend="${totalProfitLoss > 0 ? 'text-red-600' : (totalProfitLoss < 0 ? 'text-blue-600' : 'text-gray-500')}"
								th:text="'(' + ${#numbers.formatDecimal(totalProfitLossRate, 1, 2)} + '%)'">(+3.64%)</span>
					  </div>
				  </div>
			  </div>
		  </div>
			<form th:action="@{/logout}" method="post" class="mt-8">
				<button type="submit" class="w-full bg-red-500 text-white py-3 rounded-lg font-semibold hover:bg-red-600 transition-colors">ë¡œê·¸ì•„ì›ƒ</button>
			</form>
		</div>

      <!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœ: ë¡œê·¸ì¸í¼ -->
      <div th:if="${member == null}" class="h-full flex flex-col justify-center">
        <form th:action="@{/login}" method="post" class="space-y-4">
          <div>
            <label for="email" class="block text-gray-700 font-semibold mb-2">ì•„ì´ë””</label>
            <input type="text" id="email" name="email"
                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
          </div>
          <div>
            <label for="password" class="block text-gray-700 font-semibold mb-2">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="password" name="password"
                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                   placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
          </div>
          <div class="text-sm text-left">
            <a th:href="@{/members/find-id}" class="text-gray-500 hover:text-blue-600 transition-colors">ì•„ì´ë”” ì°¾ê¸°</a>
            <span class="text-gray-300 mx-1">|</span>
            <a th:href="@{/members/find-pw}" class="text-gray-500 hover:text-blue-600 transition-colors">ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°</a>
          </div>
          <button type="submit" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors">ë¡œê·¸ì¸</button>
          <div th:if="${param.error}" class="text-red-500 text-sm text-center">
            ì•„ì´ë”” ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.
          </div>
        </form>
        <div class="mt-6 text-center">
          <span class="text-gray-600">ì•„ì§ íšŒì›ì´ ì•„ë‹ˆì‹ ê°€ìš”?</span>
          <a th:href="@{/signup}" class="text-blue-600 hover:text-blue-800 font-semibold ml-2 transition-colors">íšŒì›ê°€ì…</a>
        </div>
      </div>
    </div>
  </div>
<script>
	// íƒ­ ID ë°°ì—´
	const tabs = ['board', 'stock', 'game'];

	// íƒ­ì„ í™œì„±í™”í•˜ê³  ìŠ¤íƒ€ì¼ì„ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
	function activateTab(tabId) {
		tabs.forEach(t => {
			const content = document.getElementById(`tab-${t}`);
			const btn = document.getElementById(`tab-${t}-btn`);

			// ëª¨ë“  íƒ­ ì½˜í…ì¸ ë¥¼ ìˆ¨ê¸°ê³  ë²„íŠ¼ ìŠ¤íƒ€ì¼ ì´ˆê¸°í™”
			content.classList.add('hidden');
			btn.classList.remove('bg-white', 'text-main-bg', 'border-b-4');
			btn.classList.add('bg-gray-700', 'text-white');
		});

		// ì„ íƒëœ íƒ­ ì½˜í…ì¸ ë¥¼ ë³´ì—¬ì£¼ê³  ë²„íŠ¼ì— í™œì„± ìŠ¤íƒ€ì¼ ì ìš©
		const activeContent = document.getElementById(`tab-${tabId}`);
		const activeBtn = document.getElementById(`tab-${tabId}-btn`);

		activeContent.classList.remove('hidden');
		activeBtn.classList.remove('bg-gray-700', 'text-white');
		activeBtn.classList.add('bg-white', 'text-main-bg', 'border-b-4');
	}

	// 1. í˜ì´ì§€ê°€ ë¡œë“œë  ë•Œ ì‹¤í–‰ë˜ëŠ” ë¡œì§
	window.addEventListener('DOMContentLoaded', () => {
		// localStorageì—ì„œ ë§ˆì§€ë§‰ìœ¼ë¡œ ì„ íƒí•œ íƒ­ IDë¥¼ ê°€ì ¸ì˜´
		const savedTab = localStorage.getItem('selectedTab');

		// ì €ì¥ëœ íƒ­ì´ ìˆê³ , ìœ íš¨í•œ íƒ­ IDì¸ ê²½ìš° í•´ë‹¹ íƒ­ì„ í™œì„±í™”
		if (savedTab && tabs.includes(savedTab)) {
			activateTab(savedTab);
		} else {
			// ì €ì¥ëœ íƒ­ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ 'ê²Œì‹œíŒ' íƒ­ì„ í™œì„±í™”
			activateTab('board');
		}
	});

	// 2. ê° íƒ­ ë²„íŠ¼ì— í´ë¦­ ì´ë²¤íŠ¸ ì¶”ê°€
	tabs.forEach(tabId => {
		document.getElementById(`tab-${tabId}-btn`).addEventListener('click', () => {
			// íƒ­ì„ ì‹œê°ì ìœ¼ë¡œ í™œì„±í™”
			activateTab(tabId);
			// í´ë¦­í•œ íƒ­ì˜ IDë¥¼ localStorageì— ì €ì¥
			localStorage.setItem('selectedTab', tabId);
		});
	});
</script>

<!-- ì‹¤ì‹œê°„ ì£¼ì‹ ê°€ê²© ì—…ë°ì´íŠ¸ ìŠ¤í¬ë¦½íŠ¸ -->
<script>
	// 3ì´ˆë§ˆë‹¤ updateStockPrices í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
	setInterval(updateStockPrices, 3000);

	async function updateStockPrices() {
		// ì£¼ì‹ íƒ­ì´ í™œì„±í™” ìƒíƒœì¼ ë•Œë§Œ ì—…ë°ì´íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ ì ˆì•½í•©ë‹ˆë‹¤.
		const stockTab = document.getElementById('tab-stock');
		if (stockTab.classList.contains('hidden')) {
			return;
		}

		try {
			// 1. ì„œë²„ APIì— ìµœì‹  ì£¼ì‹ ë°ì´í„°ë¥¼ ìš”ì²­í•©ë‹ˆë‹¤.
			const response = await fetch('/api/stocks');
			if (!response.ok) return;
			const latestStockList = await response.json();

			// 2. ë°›ì€ ë°ì´í„°ë¡œ ê° ì£¼ì‹ ì¹´ë“œì˜ ë‚´ìš©ì„ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
			latestStockList.forEach(stock => {
				const priceElement = document.querySelector(`#stock-card-${stock.stockId} .stock-price`);
				const changeElement = document.querySelector(`#stock-card-${stock.stockId} .stock-change`);
				const quantityElement = document.querySelector(`#stock-card-${stock.stockId} .user-quantity`);

				if (priceElement && changeElement) {
					// ê°€ê²© ì—…ë°ì´íŠ¸
					priceElement.textContent = stock.price.toLocaleString('ko-KR') + 'ì›';

					// ë³€ë™ì„± í…ìŠ¤íŠ¸ ë° ìƒ‰ìƒ ì—…ë°ì´íŠ¸
					const amount = stock.priceChangeAmount;
					const rate = stock.priceChangeRate.toFixed(2);
					const arrow = amount >= 0 ? 'â–²' : 'â–¼';

					changeElement.innerHTML = `
                        <span>${arrow}</span>
                        <span>${amount.toLocaleString('ko-KR')}</span>
                        <span class="block">(${rate}%)</span>
                    `;

					// CSS í´ë˜ìŠ¤ ë³€ê²½ìœ¼ë¡œ ìƒ‰ìƒ ì—…ë°ì´íŠ¸
					changeElement.className = 'ml-4 w-28 text-sm stock-change'; // í´ë˜ìŠ¤ ì´ˆê¸°í™”
					if (amount > 0) {
						changeElement.classList.add('text-red-500');
					} else if (amount < 0) {
						changeElement.classList.add('text-blue-500');
					} else {
						changeElement.classList.add('text-gray-400');
					}
				}

				// ë³´ìœ ìˆ˜ëŸ‰ ì—…ë°ì´íŠ¸ (ë¡œê·¸ì¸ í–ˆì„ ê²½ìš°ì—ë§Œ ìš”ì†Œê°€ ì¡´ì¬)
				if(quantityElement) {
					quantityElement.textContent = stock.userQuantity;
				}
			});
		} catch (error) {
			console.error('ì£¼ì‹ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
		}
	}
</script>

<!-- ê±°ë˜ ê²°ê³¼ ì•Œë¦¼ ìŠ¤í¬ë¦½íŠ¸ -->
<script th:inline="javascript">
	/*<![CDATA[*/
	const tradeSuccess = /*[[${tradeSuccess}]]*/ null;
	const tradeError = /*[[${tradeError}]]*/ null;

	if (tradeSuccess) {
		alert(tradeSuccess);
	}
	if (tradeError) {
		alert(tradeError);
	}
	/*]]>*/
</script>

<script>
	document.addEventListener('DOMContentLoaded', function() {
	  // ìµœì´ˆ ë©”ë‰´ ì´ë²¤íŠ¸ ì—°ê²°
	  setGameMenuEvents();
	});
	
	// ê²Œì„ ë©”ë‰´ ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²° í•¨ìˆ˜
	function setGameMenuEvents() {
	  const evenOddBtn = document.getElementById('btn-even-odd');
	  const updownBtn = document.getElementById('btn-updown');
	  if (evenOddBtn) evenOddBtn.onclick = renderEvenOddGame;
	  if (updownBtn) updownBtn.onclick = renderUpDownGame;
	}
	
	// í™€ì§ ê²Œì„ UI ë° ë¡œì§
	function renderEvenOddGame() {
	  document.getElementById('game-content').innerHTML = `
	    <button id="btn-back" class="mb-2 text-blue-400 underline text-xs">â† ë’¤ë¡œ</button>
	    <div class="mb-2 text-base font-semibold">í™€ì§ê²Œì„</div>
	    <div class="mb-2 text-sm">ë„ì „ í¬ì¸íŠ¸: <span id="eo-point">10</span></div>
	    <input type="number" id="eo-input" class="border p-1 rounded w-20 text-sm" placeholder="ìˆ«ì">
	    <div class="flex gap-1 mt-2">
	      <button id="even-btn" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">í™€</button>
	      <button id="odd-btn" class="bg-blue-500 text-white px-2 py-1 rounded text-xs">ì§</button>
	    </div>
	    <div id="eo-result" class="mt-2 text-sm"></div>
	    <div id="eo-action" class="mt-2"></div>
	  `;
	  let streak = 0;
	  let point = 10;
	  let gameActive = true;
	
	  document.getElementById('btn-back').onclick = renderGameMenu;
	
	  function play(choice) {
	    if (!gameActive) return;
	    const num = parseInt(document.getElementById('eo-input').value, 10);
	    if (isNaN(num)) {
	      document.getElementById('eo-result').innerText = 'ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.';
	      return;
	    }
	    const isEven = num % 2 === 0;
	    const win = (choice === 'í™€' && !isEven) || (choice === 'ì§' && isEven);
	    if (win) {
	      streak += 1;
	      document.getElementById('eo-result').innerText = `ì •ë‹µ! ì—°ìŠ¹: ${streak}, í¬ì¸íŠ¸: ${point}`;
	      document.getElementById('eo-action').innerHTML = `
	        <button id="eo-stop" class="bg-gray-200 text-gray-700 px-2 py-1 rounded text-xs">ë©ˆì¶”ê¸°</button>
	        <button id="eo-double" class="bg-yellow-400 text-white px-2 py-1 rounded text-xs ml-1">2ë°° ë„ì „</button>
	      `;
	      gameActive = false;
	      document.getElementById('eo-stop').onclick = function() {
	        updateGamePoint(point);
	      };
	      document.getElementById('eo-double').onclick = function() {
	        point *= 2;
	        document.getElementById('eo-point').innerText = point;
	        document.getElementById('eo-result').innerText = '';
	        document.getElementById('eo-action').innerHTML = '';
	        gameActive = true;
	      };
	    } else {
	      document.getElementById('eo-result').innerText = 'ì‹¤íŒ¨! í¬ì¸íŠ¸ íšë“ ì‹¤íŒ¨';
	      document.getElementById('eo-action').innerHTML = '';
	      streak = 0;
	      point = 10;
	    }
	  }
	
	  document.getElementById('even-btn').onclick = () => play('í™€');
	  document.getElementById('odd-btn').onclick = () => play('ì§');
	}
	
	// ì—…ë‹¤ìš´ ê²Œì„ UI ë° ë¡œì§
	function renderUpDownGame() {
	  document.getElementById('game-content').innerHTML = `
	    <button id="btn-back" class="mb-2 text-green-400 underline text-xs">â† ë’¤ë¡œ</button>
	    <div class="mb-2 text-base font-semibold">UPDOWN ê²Œì„</div>
	    <div class="mb-2 text-sm">ë‚¨ì€ ê¸°íšŒ: <span id="ud-chance">12</span> / í¬ì¸íŠ¸: <span id="ud-point">4096</span></div>
	    <input type="number" id="ud-input" class="border p-1 rounded w-20 text-sm" placeholder="1~100">
	    <button id="ud-guess" class="bg-green-500 text-white px-2 py-1 rounded text-xs ml-1">í™•ì¸</button>
	    <div id="ud-result" class="mt-2 text-sm"></div>
	  `;
	  let answer = Math.floor(Math.random() * 100) + 1;
	  let chance = 12;
	  let point = 4096;
	  let finished = false;
	
	  document.getElementById('btn-back').onclick = renderGameMenu;
	
	  document.getElementById('ud-guess').onclick = function() {
	    if (finished) return;
	    const guess = parseInt(document.getElementById('ud-input').value, 10);
	    if (isNaN(guess) || guess < 1 || guess > 100) {
	      document.getElementById('ud-result').innerText = '1~100 ì‚¬ì´ì˜ ìˆ«ì ì…ë ¥!';
	      return;
	    }
	    if (guess === answer) {
	      document.getElementById('ud-result').innerText = `ì •ë‹µ! ${point}í¬ì¸íŠ¸ íšë“!`;
	      updateGamePoint(point);
	      finished = true;
	    } else {
	      chance -= 1;
	      point = Math.max(1, Math.floor(point / 2));
	      document.getElementById('ud-chance').innerText = chance;
	      document.getElementById('ud-point').innerText = point;
	      document.getElementById('ud-result').innerText = guess < answer ? 'UP!' : 'DOWN!';
	      if (chance === 0) {
	        document.getElementById('ud-result').innerText = `ì‹¤íŒ¨! 1í¬ì¸íŠ¸ íšë“`;
	        updateGamePoint(1);
	        finished = true;
	      }
	    }
	  };
	}
	
	// ê²Œì„ ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°
	function renderGameMenu() {
	  document.getElementById('game-content').innerHTML = `
	    <div class="text-gray-600 text-base mb-4">ê²Œì„ì„ ì„ íƒí•˜ì„¸ìš”.</div>
	    <div class="flex gap-2">
	      <button id="btn-even-odd" class="px-3 py-2 bg-blue-500 text-white rounded text-sm">í™€ì§</button>
	      <button id="btn-updown" class="px-3 py-2 bg-green-500 text-white rounded text-sm">UPDOWN</button>
	    </div>
	    <div class="mt-4 text-sm text-gray-700">
	      ë‚´ í¬ì¸íŠ¸: <span id="current-point">${document.getElementById('current-point') ? document.getElementById('current-point').innerText : 0}</span>
	    </div>
	  `;
	  setGameMenuEvents();
	}
	
	// Ajaxë¡œ í¬ì¸íŠ¸ ì—…ë°ì´íŠ¸í•˜ê³ , ì„±ê³µ ì‹œ ë©”ì¸ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
	function updateGamePoint(delta) {
	  fetch('/game/point', {
	    method: 'POST',
	    headers: {'Content-Type': 'application/json'},
	    body: JSON.stringify({delta: delta})
	  })
	  .then(res => {
	    if (!res.ok) throw new Error('ì„œë²„ ì˜¤ë¥˜');
	    return res.json();
	  })
	  .then(data => {
	    // ì•ˆì „í•˜ê²Œ ìš”ì†Œ ì²´í¬ í›„ ê°±ì‹ 
	    const pointElem = document.getElementById('current-point');
	    if (pointElem) pointElem.innerText = data.point;
	    window.location.href = '/';
	  })
	  .catch(err => { alert(err.message); });
	}
</script>


<!-- íšŒì›ê°€ì… ì„±ê³µ ì•Œë¦¼ ìŠ¤í¬ë¦½íŠ¸ (ê¸°ì¡´ê³¼ ë™ì¼) -->
<script th:if="${signupSuccess}" th:inline="javascript">
	alert("íšŒì›ê°€ì…ì„ ì¶•í•˜í•©ë‹ˆë‹¤! ğŸ‰"); // ë©”ì‹œì§€ ìˆ˜ì •
</script>
</body>
</html>
